<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>í•™ìŠµ ê´€ë¦¬ ì•±</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, 'Helvetica Neue', Arial, sans-serif;
            background-color: #ffffff;
            color: #030213;
        }

        .app-container {
            height: 100vh;
            display: flex;
            flex-direction: column;
            max-width: 768px;
            margin: 0 auto;
            background-color: white;
        }

        .main-content {
            flex: 1;
            overflow-y: auto;
            padding-bottom: 64px;
        }

        .bottom-nav {
            position: fixed;
            bottom: 0;
            left: 0;
            right: 0;
            background-color: white;
            border-top: 1px solid rgba(0, 0, 0, 0.1);
            max-width: 768px;
            margin: 0 auto;
        }

        .bottom-nav-container {
            display: flex;
            height: 64px;
        }

        .nav-item {
            flex: 1;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            cursor: pointer;
            transition: all 0.3s;
            border: none;
            background: none;
        }

        .nav-item:hover {
            background-color: #f3f3f5;
        }

        .nav-item.active {
            background-color: #ececf0;
        }

        .nav-item .emoji {
            font-size: 24px;
            margin-bottom: 4px;
        }

        .nav-item .label {
            font-size: 12px;
            color: #717182;
        }

        .nav-item.active .label {
            color: #030213;
        }

        .card {
            background: white;
            border: 1px solid rgba(0, 0, 0, 0.1);
            border-radius: 10px;
            padding: 16px;
            margin-bottom: 12px;
            cursor: pointer;
            transition: box-shadow 0.3s;
        }

        .card:hover {
            box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
        }

        .progress-bar {
            width: 100%;
            height: 8px;
            background-color: #ececf0;
            border-radius: 4px;
            overflow: hidden;
        }

        .progress-fill {
            height: 100%;
            transition: width 0.3s;
        }

        .button {
            padding: 10px 20px;
            border-radius: 8px;
            border: none;
            cursor: pointer;
            font-weight: 500;
            transition: all 0.3s;
        }

        .button-primary {
            background-color: #030213;
            color: white;
        }

        .button-primary:hover {
            opacity: 0.9;
        }

        .button-primary:disabled {
            opacity: 0.5;
            cursor: not-allowed;
        }

        .button-outline {
            background-color: white;
            border: 1px solid rgba(0, 0, 0, 0.1);
            color: #030213;
        }

        .button-outline:hover {
            background-color: #f3f3f5;
        }

        .tabs {
            display: grid;
            grid-template-columns: repeat(3, 1fr);
            gap: 8px;
            margin: 16px;
            background-color: #ececf0;
            border-radius: 8px;
            padding: 4px;
        }

        .tab {
            padding: 8px;
            border-radius: 6px;
            border: none;
            background: transparent;
            cursor: pointer;
            font-weight: 500;
            transition: all 0.3s;
        }

        .tab.active {
            background-color: white;
            box-shadow: 0 1px 3px rgba(0, 0, 0, 0.1);
        }

        .flip-card {
            perspective: 1000px;
            min-height: 300px;
            cursor: pointer;
        }

        .flip-card-inner {
            position: relative;
            width: 100%;
            min-height: 300px;
            transition: transform 0.6s;
            transform-style: preserve-3d;
        }

        .flip-card.flipped .flip-card-inner {
            transform: rotateY(180deg);
        }

        .flip-card-front,
        .flip-card-back {
            position: absolute;
            width: 100%;
            min-height: 300px;
            backface-visibility: hidden;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            padding: 32px;
            background: white;
            border: 1px solid rgba(0, 0, 0, 0.1);
            border-radius: 10px;
        }

        .flip-card-back {
            transform: rotateY(180deg);
        }

        .input {
            width: 100%;
            padding: 10px 12px;
            border: 1px solid rgba(0, 0, 0, 0.1);
            border-radius: 8px;
            background-color: #f3f3f5;
            font-size: 16px;
        }

        .input:focus {
            outline: none;
            border-color: #030213;
        }

        .textarea {
            width: 100%;
            padding: 10px 12px;
            border: 1px solid rgba(0, 0, 0, 0.1);
            border-radius: 8px;
            background-color: #f3f3f5;
            font-size: 16px;
            resize: vertical;
            min-height: 100px;
        }

        .textarea:focus {
            outline: none;
            border-color: #030213;
        }

        .header {
            padding: 16px;
            border-bottom: 1px solid rgba(0, 0, 0, 0.1);
        }

        .header h1 {
            font-size: 24px;
            font-weight: 600;
            margin-bottom: 4px;
        }

        .header p {
            color: #717182;
            font-size: 14px;
        }

        .hidden {
            display: none !important;
        }

        .text-muted {
            color: #717182;
        }

        .badge {
            display: inline-block;
            padding: 4px 12px;
            border-radius: 16px;
            font-size: 14px;
            font-weight: 500;
        }

        .badge-primary {
            background-color: #030213;
            color: white;
        }

        .badge-secondary {
            background-color: #ececf0;
            color: #030213;
        }

        .toast {
            position: fixed;
            bottom: 80px;
            left: 50%;
            transform: translateX(-50%);
            background-color: #030213;
            color: white;
            padding: 12px 24px;
            border-radius: 8px;
            max-width: 90%;
            z-index: 1000;
            animation: slideUp 0.3s ease-out;
        }

        @keyframes slideUp {
            from {
                opacity: 0;
                transform: translateX(-50%) translateY(20px);
            }
            to {
                opacity: 1;
                transform: translateX(-50%) translateY(0);
            }
        }

        .modal {
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background-color: rgba(0, 0, 0, 0.5);
            display: flex;
            align-items: center;
            justify-content: center;
            z-index: 1000;
        }

        .modal-content {
            background: white;
            border-radius: 12px;
            padding: 24px;
            max-width: 90%;
            max-height: 90%;
            overflow-y: auto;
        }

        .switch {
            position: relative;
            width: 44px;
            height: 24px;
            background-color: #cbced4;
            border-radius: 12px;
            cursor: pointer;
            transition: background-color 0.3s;
        }

        .switch.active {
            background-color: #030213;
        }

        .switch-thumb {
            position: absolute;
            top: 2px;
            left: 2px;
            width: 20px;
            height: 20px;
            background-color: white;
            border-radius: 50%;
            transition: transform 0.3s;
        }

        .switch.active .switch-thumb {
            transform: translateX(20px);
        }

        .file-upload {
            border: 2px dashed rgba(0, 0, 0, 0.1);
            border-radius: 10px;
            padding: 48px;
            text-align: center;
            cursor: pointer;
            transition: border-color 0.3s;
        }

        .file-upload:hover {
            border-color: #030213;
        }

        .calendar-grid {
            display: grid;
            grid-template-columns: repeat(7, 1fr);
            gap: 4px;
            margin-top: 16px;
        }

        .calendar-day {
            aspect-ratio: 1;
            display: flex;
            align-items: center;
            justify-content: center;
            border-radius: 6px;
            cursor: pointer;
            font-size: 14px;
        }

        .calendar-day:hover {
            background-color: #f3f3f5;
        }

        .calendar-day.selected {
            background-color: #030213;
            color: white;
        }

        .calendar-day.disabled {
            color: #cbced4;
            cursor: default;
        }

        .calendar-day.disabled:hover {
            background-color: transparent;
        }

        .icon {
            width: 20px;
            height: 20px;
            stroke: currentColor;
            stroke-width: 2;
            fill: none;
        }
    </style>
</head>
<body>
    <div class="app-container">
        <div class="main-content" id="mainContent"></div>
        
        <div class="bottom-nav">
            <div class="bottom-nav-container">
                <button class="nav-item active" data-tab="main">
                    <span class="emoji">ğŸ </span>
                    <span class="label">ë©”ì¸</span>
                </button>
                <button class="nav-item" data-tab="add">
                    <span class="emoji">â•</span>
                    <span class="label">ì¶”ê°€</span>
                </button>
                <button class="nav-item" data-tab="calendar">
                    <span class="emoji">ğŸ“…</span>
                    <span class="label">ë‹¬ë ¥</span>
                </button>
                <button class="nav-item" data-tab="settings">
                    <span class="emoji">âš™ï¸</span>
                    <span class="label">ì„¤ì •</span>
                </button>
            </div>
        </div>
    </div>

    <script>
        // ì•± ìƒíƒœ
        const state = {
            activeTab: 'main',
            subjects: [
                {
                    id: "1",
                    name: "í•œêµ­ì‚¬",
                    progress: 65,
                    color: "#3b82f6"
                },
                {
                    id: "2",
                    name: "ì˜ì–´ ë¬¸ë²•",
                    progress: 42,
                    color: "#10b981"
                },
                {
                    id: "3",
                    name: "ìˆ˜í•™",
                    progress: 78,
                    color: "#f59e0b"
                }
            ],
            selectedSubject: null,
            currentView: 'main',
            subjectViewStates: {},
            quizState: null,
            vocabularyIndex: 0,
            isVocabFlipped: false,
            calendarDate: new Date(),
            plans: [
                {
                    id: "1",
                    title: "í•œêµ­ì‚¬ 1ì¥ ë³µìŠµ",
                    date: new Date(),
                    isAI: true
                }
            ]
        };

        // í€´ì¦ˆ ë°ì´í„°
        const mockQuestions = [
            {
                id: 1,
                question: "ì¡°ì„ ì‹œëŒ€ ì„¸ì¢…ëŒ€ì™•ì´ ì°½ì œí•œ ë¬¸ìëŠ”?",
                options: ["í•œì", "í›ˆë¯¼ì •ìŒ", "ì´ë‘", "í–¥ì°°"],
                correctAnswer: 1
            },
            {
                id: 2,
                question: "ì„ì§„ì™œë€ì´ ì¼ì–´ë‚œ ì—°ë„ëŠ”?",
                options: ["1492ë…„", "1592ë…„", "1692ë…„", "1792ë…„"],
                correctAnswer: 1
            },
            {
                id: 3,
                question: "ê³ ë ¤ì‹œëŒ€ íŒ”ë§ŒëŒ€ì¥ê²½ì„ ë³´ê´€í•˜ê³  ìˆëŠ” ì‚¬ì°°ì€?",
                options: ["ë¶ˆêµ­ì‚¬", "í•´ì¸ì‚¬", "í†µë„ì‚¬", "ë²”ì–´ì‚¬"],
                correctAnswer: 1
            }
        ];

        // ë…¸íŠ¸ ë°ì´í„°
        const mockNotes = [
            {
                id: 1,
                title: "ì¡°ì„ ì˜ ê±´êµ­",
                content: "1392ë…„ ì´ì„±ê³„ê°€ ìœ„í™”ë„ íšŒêµ°ì„ í†µí•´ ê³ ë ¤ë¥¼ ë¬´ë„ˆëœ¨ë¦¬ê³  ì¡°ì„ ì„ ê±´êµ­í–ˆìŠµë‹ˆë‹¤.",
                keyPoints: [
                    "ìœ„í™”ë„ íšŒêµ° (1388ë…„)",
                    "íƒœì¡° ì´ì„±ê³„ ì¦‰ìœ„ (1392ë…„)",
                    "í•œì–‘ ì²œë„ (1394ë…„)"
                ]
            },
            {
                id: 2,
                title: "ì„¸ì¢…ëŒ€ì™•ì˜ ì—…ì ",
                content: "ì¡°ì„  4ëŒ€ ì™•ì¸ ì„¸ì¢…ëŒ€ì™•ì€ í›ˆë¯¼ì •ìŒì„ ì°½ì œí•˜ê³  ê³¼í•™ê¸°ìˆ ì„ ë°œì „ì‹œì¼°ìŠµë‹ˆë‹¤.",
                keyPoints: [
                    "í›ˆë¯¼ì •ìŒ ì°½ì œ (1443ë…„)",
                    "ì¸¡ìš°ê¸°, í•´ì‹œê³„ ë°œëª…",
                    "4êµ° 6ì§„ ê°œì²™"
                ]
            },
            {
                id: 3,
                title: "ì„ì§„ì™œë€",
                content: "1592ë…„ ì¼ë³¸ì˜ ì¹¨ëµìœ¼ë¡œ ì‹œì‘ëœ 7ë…„ê°„ì˜ ì „ìŸì…ë‹ˆë‹¤.",
                keyPoints: [
                    "ì´ìˆœì‹  ì¥êµ°ì˜ í™œì•½",
                    "í•œì‚°ë„ ëŒ€ì²©, ëª…ëŸ‰í•´ì „",
                    "ì˜ë³‘ì˜ í™œë™"
                ]
            }
        ];

        // ë‹¨ì–´ì¥ ë°ì´í„°
        const mockVocabulary = [
            {
                id: 1,
                term: "í›ˆë¯¼ì •ìŒ",
                definition: "ì„¸ì¢…ëŒ€ì™•ì´ 1443ë…„ì— ì°½ì œí•œ í•œê¸€ì˜ ì›ë˜ ì´ë¦„",
                example: "ë°±ì„±ì„ ê°€ë¥´ì¹˜ëŠ” ë°”ë¥¸ ì†Œë¦¬ë¼ëŠ” ëœ»ì…ë‹ˆë‹¤."
            },
            {
                id: 2,
                term: "ê³¼ê±°ì œ",
                definition: "ê´€ë¦¬ë¥¼ ì„ ë°œí•˜ê¸° ìœ„í•œ ì‹œí—˜ ì œë„",
                example: "ê³ ë ¤ì™€ ì¡°ì„ ì‹œëŒ€ì— ì‹œí–‰ë˜ì—ˆìŠµë‹ˆë‹¤."
            },
            {
                id: 3,
                term: "ì˜ë³‘",
                definition: "ë‚˜ë¼ê°€ ìœ„ê¸°ì— ì²˜í–ˆì„ ë•Œ ìë°œì ìœ¼ë¡œ ì¼ì–´ë‚œ ì˜ë¡œìš´ êµ°ëŒ€",
                example: "ì„ì§„ì™œë€ ë•Œ í™œì•½í–ˆìŠµë‹ˆë‹¤."
            },
            {
                id: 4,
                term: "í•œì‚°ë„ ëŒ€ì²©",
                definition: "1592ë…„ ì´ìˆœì‹  ì¥êµ°ì´ í•œì‚°ë„ ì•ë°”ë‹¤ì—ì„œ ì™œêµ°ì„ í¬ê²Œ ë¬´ì°Œë¥¸ í•´ì „",
                example: "í•™ìµì§„ ì „ìˆ ì„ ì‚¬ìš©í–ˆìŠµë‹ˆë‹¤."
            },
            {
                id: 5,
                term: "ê²½êµ­ëŒ€ì „",
                definition: "ì¡°ì„ ì‹œëŒ€ ë²•ì „ìœ¼ë¡œ ì„±ì¢… ë•Œ ì™„ì„±",
                example: "ì¡°ì„ ì˜ ê¸°ë³¸ ë²•ì „ì…ë‹ˆë‹¤."
            }
        ];

        // ìœ í‹¸ë¦¬í‹° í•¨ìˆ˜
        function showToast(message) {
            const toast = document.createElement('div');
            toast.className = 'toast';
            toast.textContent = message;
            document.body.appendChild(toast);
            setTimeout(() => {
                toast.remove();
            }, 3000);
        }

        // í™”ë©´ ë Œë”ë§ í•¨ìˆ˜ë“¤
        function renderMainScreen() {
            return `
                <div>
                    <div class="header">
                        <h1>ë‚´ í•™ìŠµ</h1>
                        <p>ì§„í–‰ ì¤‘ì¸ ê³¼ëª©</p>
                    </div>
                    <div style="padding: 16px;">
                        ${state.subjects.length === 0 ? `
                            <div style="text-align: center; padding: 48px 0;">
                                <p class="text-muted">ì•„ì§ í•™ìŠµ ì¤‘ì¸ ê³¼ëª©ì´ ì—†ìŠµë‹ˆë‹¤</p>
                                <p class="text-muted" style="margin-top: 8px;">â• ë²„íŠ¼ì„ ëˆŒëŸ¬ ê³¼ëª©ì„ ì¶”ê°€í•´ë³´ì„¸ìš”</p>
                            </div>
                        ` : state.subjects.map(subject => `
                            <div class="card" onclick="selectSubject('${subject.id}')">
                                <div style="display: flex; justify-content: space-between; margin-bottom: 8px;">
                                    <h3 style="font-size: 18px; font-weight: 600;">${subject.name}</h3>
                                    <span class="text-muted">${subject.progress}%</span>
                                </div>
                                <div class="progress-bar">
                                    <div class="progress-fill" style="width: ${subject.progress}%; background-color: ${subject.color};"></div>
                                </div>
                            </div>
                        `).join('')}
                    </div>
                </div>
            `;
        }

        function renderSubjectDetail() {
            const subject = state.selectedSubject;
            const currentView = state.subjectViewStates[subject.id] || 'quiz-start';
            const isViewActive = ['quiz', 'notes', 'vocabulary'].includes(currentView);

            return `
                <div>
                    <div class="header" style="display: flex; align-items: center; gap: 12px;">
                        <button onclick="goBackFromSubject()" class="button-outline" style="padding: 8px; border-radius: 50%; width: 40px; height: 40px;">
                            â†
                        </button>
                        <div style="flex: 1;">
                            <h1 style="font-size: 20px;">${subject.name}</h1>
                            <p>ì§„ë„ìœ¨: ${subject.progress}%</p>
                        </div>
                    </div>

                    ${!isViewActive ? `
                        <div class="tabs">
                            <button class="tab ${currentView.startsWith('quiz') ? 'active' : ''}" 
                                    onclick="changeSubjectView('quiz-start')">í€´ì¦ˆ</button>
                            <button class="tab ${currentView.startsWith('notes') ? 'active' : ''}" 
                                    onclick="changeSubjectView('notes-start')">ë…¸íŠ¸ì •ë¦¬</button>
                            <button class="tab ${currentView.startsWith('vocabulary') ? 'active' : ''}" 
                                    onclick="changeSubjectView('vocabulary-start')">ë‹¨ì–´ì¥</button>
                        </div>
                    ` : ''}

                    <div style="padding: 16px;">
                        ${renderSubjectContent(currentView)}
                    </div>
                </div>
            `;
        }

        function renderSubjectContent(view) {
            if (view === 'quiz-start') {
                return `
                    <div class="card" style="padding: 24px; text-align: center;">
                        <h3 style="margin-bottom: 16px;">í€´ì¦ˆ</h3>
                        <p class="text-muted" style="margin-bottom: 16px;">
                            AIê°€ ìƒì„±í•œ í€´ì¦ˆë¡œ í•™ìŠµ ë‚´ìš©ì„ ë³µìŠµí•˜ì„¸ìš”
                        </p>
                        <button class="button button-primary" onclick="startQuiz()">í€´ì¦ˆ ì‹œì‘í•˜ê¸°</button>
                    </div>
                `;
            } else if (view === 'quiz') {
                return renderQuiz();
            } else if (view === 'notes-start') {
                return `
                    <div class="card" style="padding: 24px; text-align: center;">
                        <h3 style="margin-bottom: 16px;">ë…¸íŠ¸ì •ë¦¬</h3>
                        <p class="text-muted" style="margin-bottom: 16px;">
                            í•µì‹¬ ë‚´ìš©ì„ ì •ë¦¬í•œ ë…¸íŠ¸ë¥¼ í™•ì¸í•˜ì„¸ìš”
                        </p>
                        <button class="button button-primary" onclick="changeSubjectView('notes')">ë…¸íŠ¸ ë³´ê¸°</button>
                    </div>
                `;
            } else if (view === 'notes') {
                return renderNotes();
            } else if (view === 'vocabulary-start') {
                return `
                    <div class="card" style="padding: 24px; text-align: center;">
                        <h3 style="margin-bottom: 16px;">ë‹¨ì–´ì¥</h3>
                        <p class="text-muted" style="margin-bottom: 16px;">
                            ì¤‘ìš” ë‹¨ì–´ì™€ ê°œë…ì„ ë³µìŠµí•˜ì„¸ìš”
                        </p>
                        <button class="button button-primary" onclick="changeSubjectView('vocabulary')">ë‹¨ì–´ì¥ ì—´ê¸°</button>
                    </div>
                `;
            } else if (view === 'vocabulary') {
                return renderVocabulary();
            }
            return '';
        }

        function renderQuiz() {
            if (!state.quizState) {
                state.quizState = {
                    currentQuestion: 0,
                    selectedAnswer: null,
                    score: 0,
                    answeredQuestions: new Array(mockQuestions.length).fill(false),
                    showResult: false
                };
            }

            const qs = state.quizState;

            if (qs.showResult) {
                const percentage = Math.round((qs.score / mockQuestions.length) * 100);
                return `
                    <div class="card" style="padding: 32px; text-align: center;">
                        <h2 style="margin-bottom: 16px;">í€´ì¦ˆ ì™„ë£Œ!</h2>
                        <div style="margin: 32px 0;">
                            <div style="display: inline-flex; align-items: center; justify-content: center; width: 128px; height: 128px; border-radius: 50%; background-color: #030213; color: white; margin-bottom: 16px;">
                                <span style="font-size: 32px;">${qs.score}/${mockQuestions.length}</span>
                            </div>
                            <p class="text-muted">ì •ë‹µë¥ : ${percentage}%</p>
                        </div>
                        <div style="display: flex; gap: 12px;">
                            <button class="button button-outline" style="flex: 1;" onclick="restartQuiz()">ë‹¤ì‹œ í’€ê¸°</button>
                            <button class="button button-primary" style="flex: 1;" onclick="completeQuiz()">ì™„ë£Œ</button>
                        </div>
                    </div>
                `;
            }

            const question = mockQuestions[qs.currentQuestion];
            const progress = ((qs.currentQuestion + 1) / mockQuestions.length) * 100;

            return `
                <div>
                    <div class="card" style="padding: 16px; margin-bottom: 16px;">
                        <div style="display: flex; justify-content: space-between; margin-bottom: 8px;">
                            <span class="text-muted">ë¬¸ì œ ${qs.currentQuestion + 1} / ${mockQuestions.length}</span>
                            <span class="text-muted">${Math.round(progress)}%</span>
                        </div>
                        <div class="progress-bar">
                            <div class="progress-fill" style="width: ${progress}%; background-color: #030213;"></div>
                        </div>
                    </div>

                    <div class="card" style="padding: 24px;">
                        <h3 style="margin-bottom: 24px;">${question.question}</h3>
                        <div style="display: flex; flex-direction: column; gap: 12px; margin-bottom: 24px;">
                            ${question.options.map((option, index) => {
                                const isSelected = qs.selectedAnswer === index;
                                const isAnswered = qs.answeredQuestions[qs.currentQuestion];
                                const isCorrect = index === question.correctAnswer;
                                
                                let buttonStyle = '';
                                if (isAnswered) {
                                    if (isCorrect) {
                                        buttonStyle = 'border-color: #10b981; background-color: #dcfce7;';
                                    } else if (isSelected && !isCorrect) {
                                        buttonStyle = 'border-color: #ef4444; background-color: #fee2e2;';
                                    }
                                } else if (isSelected) {
                                    buttonStyle = 'background-color: #030213; color: white;';
                                }
                                
                                return `
                                    <button class="button button-outline" 
                                            style="width: 100%; text-align: left; padding: 16px; ${buttonStyle}"
                                            onclick="selectAnswer(${index})"
                                            ${isAnswered ? 'disabled' : ''}>
                                        <div style="display: flex; justify-content: space-between; align-items: center;">
                                            <span>${option}</span>
                                            ${isAnswered && isCorrect ? '<span style="color: #10b981;">âœ“</span>' : ''}
                                            ${isAnswered && isSelected && !isCorrect ? '<span style="color: #ef4444;">âœ—</span>' : ''}
                                        </div>
                                    </button>
                                `;
                            }).join('')}
                        </div>

                        ${!qs.answeredQuestions[qs.currentQuestion] ? `
                            <button class="button button-primary" 
                                    style="width: 100%;" 
                                    onclick="submitAnswer()"
                                    ${qs.selectedAnswer === null ? 'disabled' : ''}>
                                ì •ë‹µ í™•ì¸
                            </button>
                        ` : `
                            <button class="button button-primary" style="width: 100%;" onclick="nextQuestion()">
                                ${qs.currentQuestion < mockQuestions.length - 1 ? 'ë‹¤ìŒ ë¬¸ì œ' : 'ê²°ê³¼ ë³´ê¸°'}
                            </button>
                        `}
                    </div>
                </div>
            `;
        }

        function renderNotes() {
            return `
                <div>
                    <div class="card" style="padding: 16px; background-color: #ececf0; margin-bottom: 16px;">
                        <p class="text-muted">ğŸ“– AIê°€ í•™ìŠµ ìë£Œë¥¼ ë¶„ì„í•˜ì—¬ í•µì‹¬ ë‚´ìš©ì„ ì •ë¦¬í–ˆìŠµë‹ˆë‹¤</p>
                    </div>

                    ${mockNotes.map((note, index) => `
                        <div class="card" style="padding: 24px; margin-bottom: 16px;">
                            <div style="display: flex; gap: 12px; margin-bottom: 16px;">
                                <div style="display: flex; align-items: center; justify-content: center; width: 32px; height: 32px; border-radius: 50%; background-color: #030213; color: white; flex-shrink: 0;">
                                    ${index + 1}
                                </div>
                                <div style="flex: 1;">
                                    <h3 style="margin-bottom: 8px;">${note.title}</h3>
                                    <p class="text-muted">${note.content}</p>
                                </div>
                            </div>
                            <hr style="margin: 16px 0; border: none; border-top: 1px solid rgba(0, 0, 0, 0.1);">
                            <div>
                                <h4 style="margin-bottom: 12px; display: flex; align-items: center; gap: 8px;">
                                    <span style="color: #f59e0b;">â­</span>
                                    í•µì‹¬ í¬ì¸íŠ¸
                                </h4>
                                <ul style="list-style: none; padding: 0;">
                                    ${note.keyPoints.map(point => `
                                        <li style="display: flex; gap: 8px; margin-bottom: 8px;">
                                            <span style="color: #030213;">â€¢</span>
                                            <span>${point}</span>
                                        </li>
                                    `).join('')}
                                </ul>
                            </div>
                        </div>
                    `).join('')}

                    <div class="card" style="padding: 24px; background-color: #dbeafe; border-color: #93c5fd;">
                        <div style="display: flex; gap: 12px;">
                            <span style="font-size: 20px;">ğŸ’¡</span>
                            <div>
                                <h4 style="margin-bottom: 8px;">í•™ìŠµ íŒ</h4>
                                <p class="text-muted">
                                    ê° ì£¼ì œì˜ í•µì‹¬ í¬ì¸íŠ¸ë¥¼ ì¤‘ì‹¬ìœ¼ë¡œ ë³µìŠµí•˜ë©´ ë” íš¨ê³¼ì ìœ¼ë¡œ í•™ìŠµí•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.
                                    ì—°ëŒ€ê¸°ë¥¼ ì •ë¦¬í•˜ë©´ì„œ ì—­ì‚¬ì˜ íë¦„ì„ ì´í•´í•´ë³´ì„¸ìš”.
                                </p>
                            </div>
                        </div>
                    </div>
                </div>
            `;
        }

        function renderVocabulary() {
            const currentCard = mockVocabulary[state.vocabularyIndex];
            
            return `
                <div>
                    <div class="card" style="padding: 16px; background-color: #ececf0; margin-bottom: 16px;">
                        <div style="display: flex; justify-content: space-between; align-items: center;">
                            <p class="text-muted">${state.vocabularyIndex + 1} / ${mockVocabulary.length} ë‹¨ì–´</p>
                            <button class="button button-outline" style="padding: 6px 12px; font-size: 14px;" onclick="resetVocabulary()">
                                ğŸ”„ ì²˜ìŒë¶€í„°
                            </button>
                        </div>
                    </div>

                    <div class="flip-card ${state.isVocabFlipped ? 'flipped' : ''}" onclick="flipVocabCard()">
                        <div class="flip-card-inner">
                            <div class="flip-card-front">
                                <div style="text-align: center;">
                                    <span class="badge badge-primary" style="margin-bottom: 16px;">ìš©ì–´</span>
                                    <h2 style="margin-bottom: 16px; font-size: 28px;">${currentCard.term}</h2>
                                    <p class="text-muted">ì¹´ë“œë¥¼ í´ë¦­í•˜ì—¬ ëœ»ì„ í™•ì¸í•˜ì„¸ìš”</p>
                                </div>
                            </div>
                            <div class="flip-card-back">
                                <div style="text-align: center;">
                                    <span class="badge badge-secondary" style="margin-bottom: 16px;">ëœ»</span>
                                    <p style="margin-bottom: 16px;">${currentCard.definition}</p>
                                    ${currentCard.example ? `
                                        <div style="margin-top: 24px; padding: 16px; background-color: #ececf0; border-radius: 8px;">
                                            <p class="text-muted">${currentCard.example}</p>
                                        </div>
                                    ` : ''}
                                </div>
                            </div>
                        </div>
                    </div>

                    <div style="display: flex; gap: 12px; margin-top: 16px;">
                        <button class="button button-outline" style="flex: 1;" onclick="previousVocab()">
                            â† ì´ì „
                        </button>
                        <button class="button button-outline" style="flex: 1;" onclick="nextVocab()">
                            ë‹¤ìŒ â†’
                        </button>
                    </div>

                    <div class="card" style="padding: 16px; background-color: #dbeafe; border-color: #93c5fd; margin-top: 16px;">
                        <p style="text-align: center;" class="text-muted">
                            ğŸ’¡ í™”ì‚´í‘œ ë²„íŠ¼ìœ¼ë¡œ ë‹¨ì–´ë¥¼ ë„˜ê¸°ê³ , ì¹´ë“œë¥¼ í´ë¦­í•˜ì—¬ ëœ»ì„ í™•ì¸í•˜ì„¸ìš”
                        </p>
                    </div>
                </div>
            `;
        }

        function renderAddSubject() {
            return `
                <div>
                    <div class="header">
                        <h1>ê³¼ëª© ì¶”ê°€</h1>
                        <p>PPT ë˜ëŠ” PDF íŒŒì¼ì„ ì—…ë¡œë“œí•˜ì„¸ìš”</p>
                    </div>
                    <div style="padding: 16px;">
                        <div class="card" style="padding: 32px;">
                            <div class="file-upload" onclick="document.getElementById('fileInput').click()">
                                <div style="font-size: 48px; margin-bottom: 16px;">ğŸ“¤</div>
                                <p style="margin-bottom: 8px;">íŒŒì¼ì„ ì„ íƒí•˜ê±°ë‚˜ ë“œë˜ê·¸í•˜ì„¸ìš”</p>
                                <p class="text-muted">PPT, PDF íŒŒì¼ ì§€ì›</p>
                            </div>
                            <input type="file" id="fileInput" accept=".pdf,.ppt,.pptx" style="display: none;" onchange="handleFileSelect(event)">
                        </div>
                    </div>
                </div>
            `;
        }

        function renderAddSubjectForm(fileName) {
            return `
                <div>
                    <div class="header">
                        <h1>ê³¼ëª© ì¶”ê°€</h1>
                        <p>PPT ë˜ëŠ” PDF íŒŒì¼ì„ ì—…ë¡œë“œí•˜ì„¸ìš”</p>
                    </div>
                    <div style="padding: 16px;">
                        <div class="card" style="padding: 16px; margin-bottom: 16px;">
                            <div style="display: flex; gap: 12px; align-items: center;">
                                <div style="font-size: 32px;">ğŸ“„</div>
                                <div style="flex: 1;">
                                    <p>${fileName}</p>
                                    <p class="text-muted" style="font-size: 14px;">íŒŒì¼ ì„ íƒë¨</p>
                                </div>
                            </div>
                        </div>

                        <div class="card" style="padding: 24px;">
                            <div style="margin-bottom: 16px;">
                                <label style="display: block; margin-bottom: 8px; font-weight: 500;">ê³¼ëª©ëª… *</label>
                                <input type="text" id="subjectName" class="input" placeholder="ì˜ˆ: í•œêµ­ì‚¬, ì˜ì–´ ë¬¸ë²• ë“±">
                            </div>
                            <div style="margin-bottom: 24px;">
                                <label style="display: block; margin-bottom: 8px; font-weight: 500;">ê³¼ëª© ì„¤ëª…</label>
                                <textarea id="subjectDesc" class="textarea" placeholder="ê³¼ëª©ì— ëŒ€í•œ ê°„ë‹¨í•œ ì„¤ëª…ì„ ì…ë ¥í•˜ì„¸ìš” (ì„ íƒì‚¬í•­)"></textarea>
                            </div>
                            <div style="display: flex; gap: 12px;">
                                <button class="button button-outline" style="flex: 1;" onclick="cancelAddSubject()">ì·¨ì†Œ</button>
                                <button class="button button-primary" style="flex: 1;" onclick="saveSubject()">ì €ì¥</button>
                            </div>
                        </div>
                    </div>
                </div>
            `;
        }

        function renderCalendar() {
            const today = new Date();
            const currentMonth = state.calendarDate.getMonth();
            const currentYear = state.calendarDate.getFullYear();
            
            const firstDay = new Date(currentYear, currentMonth, 1);
            const lastDay = new Date(currentYear, currentMonth + 1, 0);
            const daysInMonth = lastDay.getDate();
            const startingDayOfWeek = firstDay.getDay();

            const monthNames = ['1ì›”', '2ì›”', '3ì›”', '4ì›”', '5ì›”', '6ì›”', '7ì›”', '8ì›”', '9ì›”', '10ì›”', '11ì›”', '12ì›”'];
            const dayNames = ['ì¼', 'ì›”', 'í™”', 'ìˆ˜', 'ëª©', 'ê¸ˆ', 'í† '];

            const selectedDatePlans = state.plans.filter(plan => 
                plan.date.toDateString() === state.calendarDate.toDateString()
            );

            return `
                <div>
                    <div class="header">
                        <h1>í•™ìŠµ ê³„íš</h1>
                        <p>ë‚˜ì˜ í•™ìŠµ ì¼ì •ì„ ê´€ë¦¬í•˜ì„¸ìš”</p>
                    </div>
                    <div style="padding: 16px;">
                        <div class="card" style="padding: 16px; margin-bottom: 16px;">
                            <div style="display: flex; justify-content: between; align-items: center; margin-bottom: 16px;">
                                <h3>${currentYear}ë…„ ${monthNames[currentMonth]}</h3>
                            </div>
                            <div class="calendar-grid">
                                ${dayNames.map(day => `<div style="text-align: center; font-weight: 500; color: #717182; padding: 8px;">${day}</div>`).join('')}
                                ${Array(startingDayOfWeek).fill(0).map(() => '<div></div>').join('')}
                                ${Array(daysInMonth).fill(0).map((_, i) => {
                                    const day = i + 1;
                                    const date = new Date(currentYear, currentMonth, day);
                                    const isSelected = date.toDateString() === state.calendarDate.toDateString();
                                    return `
                                        <div class="calendar-day ${isSelected ? 'selected' : ''}" onclick="selectCalendarDate(${day})">
                                            ${day}
                                        </div>
                                    `;
                                }).join('')}
                            </div>
                        </div>

                        <div class="card" style="padding: 16px;">
                            <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 16px;">
                                <h3>${state.calendarDate.toLocaleDateString('ko-KR', { year: 'numeric', month: 'long', day: 'numeric' })}</h3>
                                <div style="display: flex; gap: 8px;">
                                    <button class="button button-outline" style="padding: 6px 12px; font-size: 14px;" onclick="showAddPlanModal()">
                                        â• ì¶”ê°€
                                    </button>
                                    <button class="button button-primary" style="padding: 6px 12px; font-size: 14px;" onclick="addAIPlan()">
                                        âœ¨ AI ì¶”ì²œ
                                    </button>
                                </div>
                            </div>
                            <div>
                                ${selectedDatePlans.length === 0 ? `
                                    <p style="text-align: center; padding: 32px 0;" class="text-muted">ì´ ë‚ ì§œì— ê³„íšì´ ì—†ìŠµë‹ˆë‹¤</p>
                                ` : selectedDatePlans.map(plan => `
                                    <div style="padding: 12px; background-color: #ececf0; border-radius: 8px; margin-bottom: 8px; display: flex; justify-content: space-between; align-items: center;">
                                        <span>${plan.title}</span>
                                        ${plan.isAI ? '<span class="badge badge-primary" style="font-size: 12px;">AI ì¶”ì²œ</span>' : ''}
                                    </div>
                                `).join('')}
                            </div>
                        </div>
                    </div>
                </div>
            `;
        }

        function renderSettings() {
            return `
                <div>
                    <div class="header">
                        <h1>ì„¤ì •</h1>
                        <p>ê³„ì • ë° ì•± ì„¤ì •</p>
                    </div>
                    <div style="padding: 16px;">
                        <div class="card" style="padding: 24px; margin-bottom: 16px;">
                            <h3 style="margin-bottom: 16px;">ê³„ì • ì •ë³´</h3>
                            <div style="margin-bottom: 16px;">
                                <label style="display: block; margin-bottom: 8px; font-weight: 500;">ğŸ‘¤ ì´ë¦„</label>
                                <input type="text" class="input" value="í™ê¸¸ë™">
                            </div>
                            <div style="margin-bottom: 16px;">
                                <label style="display: block; margin-bottom: 8px; font-weight: 500;">âœ‰ï¸ ì´ë©”ì¼</label>
                                <input type="email" class="input" value="user@example.com">
                            </div>
                            <div>
                                <label style="display: block; margin-bottom: 8px; font-weight: 500;">ğŸ”’ ë¹„ë°€ë²ˆí˜¸</label>
                                <button class="button button-outline" style="width: 100%;">ë¹„ë°€ë²ˆí˜¸ ë³€ê²½</button>
                            </div>
                        </div>

                        <div class="card" style="padding: 24px; margin-bottom: 16px;">
                            <h3 style="margin-bottom: 16px;">ì•± ì„¤ì •</h3>
                            <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 16px; padding-bottom: 16px; border-bottom: 1px solid rgba(0, 0, 0, 0.1);">
                                <div>
                                    <label style="display: block; font-weight: 500;">ğŸ”” ì•Œë¦¼ ì„¤ì •</label>
                                    <p class="text-muted" style="font-size: 14px;">í•™ìŠµ ì•Œë¦¼ ë°›ê¸°</p>
                                </div>
                                <div class="switch active" onclick="this.classList.toggle('active')">
                                    <div class="switch-thumb"></div>
                                </div>
                            </div>
                            <div style="display: flex; justify-content: space-between; align-items: center;">
                                <div>
                                    <label style="display: block; font-weight: 500;">ğŸŒ™ ë‹¤í¬ ëª¨ë“œ</label>
                                    <p class="text-muted" style="font-size: 14px;">ì–´ë‘ìš´ í…Œë§ˆ ì‚¬ìš©</p>
                                </div>
                                <div class="switch" onclick="this.classList.toggle('active')">
                                    <div class="switch-thumb"></div>
                                </div>
                            </div>
                        </div>

                        <div class="card" style="padding: 24px; margin-bottom: 16px;">
                            <h3 style="margin-bottom: 16px;">í•™ìŠµ ëª©í‘œ</h3>
                            <div>
                                <label style="display: block; margin-bottom: 8px; font-weight: 500;">ì¼ì¼ í•™ìŠµ ëª©í‘œ (ë¶„)</label>
                                <input type="number" class="input" value="60">
                            </div>
                        </div>

                        <div style="display: flex; gap: 12px;">
                            <button class="button button-primary" style="flex: 1;">ì €ì¥</button>
                            <button class="button button-outline" style="flex: 1;">ë¡œê·¸ì•„ì›ƒ</button>
                        </div>
                    </div>
                </div>
            `;
        }

        // ì´ë²¤íŠ¸ í•¸ë“¤ëŸ¬
        function selectSubject(id) {
            state.selectedSubject = state.subjects.find(s => s.id === id);
            state.currentView = 'subject-detail';
            render();
        }

        function goBackFromSubject() {
            state.selectedSubject = null;
            state.currentView = 'main';
            if (state.selectedSubject) {
                delete state.subjectViewStates[state.selectedSubject.id];
            }
            state.quizState = null;
            state.vocabularyIndex = 0;
            state.isVocabFlipped = false;
            render();
        }

        function changeSubjectView(view) {
            if (state.selectedSubject) {
                state.subjectViewStates[state.selectedSubject.id] = view;
                if (view === 'vocabulary') {
                    state.vocabularyIndex = 0;
                    state.isVocabFlipped = false;
                }
                render();
            }
        }

        // í€´ì¦ˆ í•¨ìˆ˜
        function startQuiz() {
            state.quizState = {
                currentQuestion: 0,
                selectedAnswer: null,
                score: 0,
                answeredQuestions: new Array(mockQuestions.length).fill(false),
                showResult: false
            };
            changeSubjectView('quiz');
        }

        function selectAnswer(index) {
            if (!state.quizState.answeredQuestions[state.quizState.currentQuestion]) {
                state.quizState.selectedAnswer = index;
                render();
            }
        }

        function submitAnswer() {
            if (state.quizState.selectedAnswer === null) return;
            
            const qs = state.quizState;
            qs.answeredQuestions[qs.currentQuestion] = true;
            
            const question = mockQuestions[qs.currentQuestion];
            if (qs.selectedAnswer === question.correctAnswer) {
                qs.score++;
            }
            
            render();
        }

        function nextQuestion() {
            const qs = state.quizState;
            if (qs.currentQuestion < mockQuestions.length - 1) {
                qs.currentQuestion++;
                qs.selectedAnswer = null;
            } else {
                qs.showResult = true;
            }
            render();
        }

        function restartQuiz() {
            startQuiz();
        }

        function completeQuiz() {
            changeSubjectView('quiz-start');
        }

        // ë‹¨ì–´ì¥ í•¨ìˆ˜
        function flipVocabCard() {
            state.isVocabFlipped = !state.isVocabFlipped;
            render();
        }

        function previousVocab() {
            state.isVocabFlipped = false;
            state.vocabularyIndex = state.vocabularyIndex > 0 ? state.vocabularyIndex - 1 : mockVocabulary.length - 1;
            render();
        }

        function nextVocab() {
            state.isVocabFlipped = false;
            state.vocabularyIndex = state.vocabularyIndex < mockVocabulary.length - 1 ? state.vocabularyIndex + 1 : 0;
            render();
        }

        function resetVocabulary() {
            state.vocabularyIndex = 0;
            state.isVocabFlipped = false;
            render();
        }

        // ê³¼ëª© ì¶”ê°€ í•¨ìˆ˜
        let selectedFileName = '';

        function handleFileSelect(event) {
            const file = event.target.files[0];
            if (file) {
                selectedFileName = file.name;
                document.getElementById('mainContent').innerHTML = renderAddSubjectForm(file.name);
            }
        }

        function cancelAddSubject() {
            selectedFileName = '';
            render();
        }

        function saveSubject() {
            const name = document.getElementById('subjectName').value.trim();
            if (!name) {
                alert('ê³¼ëª©ëª…ì„ ì…ë ¥í•´ì£¼ì„¸ìš”');
                return;
            }

            const newSubject = {
                id: Date.now().toString(),
                name: name,
                progress: 0,
                color: '#' + Math.floor(Math.random()*16777215).toString(16)
            };

            state.subjects.push(newSubject);
            showToast(`"${name}" ê³¼ëª©ì´ ì¶”ê°€ë˜ì—ˆìŠµë‹ˆë‹¤! AIê°€ í€´ì¦ˆë¥¼ ìƒì„±í–ˆìŠµë‹ˆë‹¤.`);
            state.activeTab = 'main';
            selectedFileName = '';
            render();
        }

        // ë‹¬ë ¥ í•¨ìˆ˜
        function selectCalendarDate(day) {
            const currentMonth = state.calendarDate.getMonth();
            const currentYear = state.calendarDate.getFullYear();
            state.calendarDate = new Date(currentYear, currentMonth, day);
            render();
        }

        function showAddPlanModal() {
            const modal = document.createElement('div');
            modal.className = 'modal';
            modal.innerHTML = `
                <div class="modal-content" style="width: 400px; max-width: 90%;">
                    <h3 style="margin-bottom: 16px;">ìƒˆ ê³„íš ì¶”ê°€</h3>
                    <div style="margin-bottom: 16px;">
                        <label style="display: block; margin-bottom: 8px; font-weight: 500;">ê³„íš ë‚´ìš©</label>
                        <input type="text" id="planTitle" class="input" placeholder="í•™ìŠµ ê³„íšì„ ì…ë ¥í•˜ì„¸ìš”">
                    </div>
                    <div style="display: flex; gap: 12px;">
                        <button class="button button-outline" style="flex: 1;" onclick="this.closest('.modal').remove()">ì·¨ì†Œ</button>
                        <button class="button button-primary" style="flex: 1;" onclick="addPlan()">ì¶”ê°€í•˜ê¸°</button>
                    </div>
                </div>
            `;
            modal.onclick = (e) => {
                if (e.target === modal) modal.remove();
            };
            document.body.appendChild(modal);
        }

        function addPlan() {
            const title = document.getElementById('planTitle').value.trim();
            if (!title) return;

            const newPlan = {
                id: Date.now().toString(),
                title: title,
                date: new Date(state.calendarDate),
                isAI: false
            };

            state.plans.push(newPlan);
            document.querySelector('.modal').remove();
            render();
        }

        function addAIPlan() {
            const aiSuggestions = [
                "ì˜ì–´ ë‹¨ì–´ 30ê°œ ì•”ê¸°",
                "ìˆ˜í•™ ë¬¸ì œ í’€ì´ ë³µìŠµ",
                "ê³¼í•™ ë…¸íŠ¸ ì •ë¦¬",
                "ì—­ì‚¬ ìš”ì•½ë³¸ ì‘ì„±"
            ];

            const randomSuggestion = aiSuggestions[Math.floor(Math.random() * aiSuggestions.length)];

            const aiPlan = {
                id: Date.now().toString(),
                title: randomSuggestion,
                date: new Date(state.calendarDate),
                isAI: true
            };

            state.plans.push(aiPlan);
            render();
        }

        // ë©”ì¸ ë Œë”ë§ í•¨ìˆ˜
        function render() {
            const content = document.getElementById('mainContent');
            
            if (state.selectedSubject) {
                content.innerHTML = renderSubjectDetail();
            } else {
                switch (state.activeTab) {
                    case 'main':
                        content.innerHTML = renderMainScreen();
                        break;
                    case 'add':
                        content.innerHTML = renderAddSubject();
                        break;
                    case 'calendar':
                        content.innerHTML = renderCalendar();
                        break;
                    case 'settings':
                        content.innerHTML = renderSettings();
                        break;
                    default:
                        content.innerHTML = renderMainScreen();
                }
            }

            // ë„¤ë¹„ê²Œì´ì…˜ í™œì„±í™” ìƒíƒœ ì—…ë°ì´íŠ¸
            document.querySelectorAll('.nav-item').forEach(item => {
                item.classList.remove('active');
                if (item.dataset.tab === (state.selectedSubject ? 'main' : state.activeTab)) {
                    item.classList.add('active');
                }
            });
        }

        // í•˜ë‹¨ ë„¤ë¹„ê²Œì´ì…˜ ì´ë²¤íŠ¸ ë¦¬ìŠ¤ë„ˆ
        document.querySelectorAll('.nav-item').forEach(item => {
            item.addEventListener('click', () => {
                state.activeTab = item.dataset.tab;
                state.selectedSubject = null;
                state.quizState = null;
                state.vocabularyIndex = 0;
                state.isVocabFlipped = false;
                render();
            });
        });

        // ì´ˆê¸° ë Œë”ë§
        render();
    </script>
</body>
</html>
